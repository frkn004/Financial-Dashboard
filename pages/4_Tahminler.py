import streamlit as stimport pandas as pdimport numpy as npfrom datetime import datetime, timedeltaimport plotly.graph_objects as gofrom plotly.subplots import make_subplotsfrom sklearn.linear_model import LinearRegressionfrom sklearn.metrics import r2_score, mean_squared_errorfrom utils.data_loader import calculate_metricsfrom utils.predictions import create_sales_prediction, create_expense_predictiondef show_predictions():    st.title("ğŸ“ˆ Tahminler")    if 'data' not in st.session_state or st.session_state.data is None:        st.info("ğŸ‘† LÃ¼tfen sol menÃ¼den bir veri dosyasÄ± yÃ¼kleyin.")        return    data = st.session_state.data    metrics = calculate_metrics(data)    if metrics:        # Tahmin parametreleri        st.sidebar.markdown("### ğŸ¯ Tahmin Parametreleri")        prediction_type = st.sidebar.selectbox(            "Tahmin TÃ¼rÃ¼",            ["SatÄ±ÅŸ Tahmini", "Gider Tahmini", "Kar Tahmini"]        )        periods = st.sidebar.slider(            "Tahmin DÃ¶nemi (Ay)",            min_value=1,            max_value=6,            value=3        )        confidence = st.sidebar.slider(            "GÃ¼ven AralÄ±ÄŸÄ± (%)",            min_value=80,            max_value=99,            value=95        )        if prediction_type == "SatÄ±ÅŸ Tahmini":            show_sales_prediction(metrics, periods, confidence)        elif prediction_type == "Gider Tahmini":            show_expense_prediction(metrics, periods, confidence)        else:            show_profit_prediction(metrics, periods, confidence)def show_sales_prediction(metrics, periods, confidence):    """SatÄ±ÅŸ tahmini gÃ¶ster"""    predictions, pred_metrics = create_sales_prediction(metrics, periods)    if predictions is not None and pred_metrics is not None:        st.subheader("ğŸ“Š SatÄ±ÅŸ Tahmini")        # Tahmin grafiÄŸi        months = ['Ocak', 'Åubat', 'Mart', 'Nisan', 'MayÄ±s',                  'Haziran', 'Temmuz', 'AÄŸustos', 'EylÃ¼l', 'Ekim']        future_months = ['KasÄ±m', 'AralÄ±k', 'Ocak'][:periods]        fig = go.Figure()        # GeÃ§miÅŸ veriler        fig.add_trace(go.Scatter(            x=months,            y=metrics['monthly_sales'],            name='GerÃ§ekleÅŸen',            mode='lines+markers',            line=dict(color='#2E86C1', width=2)        ))        # Tahminler        fig.add_trace(go.Scatter(            x=future_months,            y=predictions,            name='Tahmin',            mode='lines+markers',            line=dict(color='#E74C3C', width=2, dash='dash')        ))        # GÃ¼ven aralÄ±ÄŸÄ±        conf_factor = 1.96 if confidence == 95 else 2.57  # 95% veya 99% gÃ¼ven aralÄ±ÄŸÄ±        upper_bound = predictions + pred_metrics['rmse'] * conf_factor        lower_bound = predictions - pred_metrics['rmse'] * conf_factor        fig.add_trace(go.Scatter(            x=future_months + future_months[::-1],            y=list(upper_bound) + list(lower_bound)[::-1],            fill='toself',            fillcolor='rgba(231, 76, 60, 0.2)',            line=dict(color='rgba(231, 76, 60, 0)'),            name=f'%{confidence} GÃ¼ven AralÄ±ÄŸÄ±'        ))        fig.update_layout(            title="SatÄ±ÅŸ Tahmin GrafiÄŸi",            xaxis_title="Ay",            yaxis_title="SatÄ±ÅŸ (TL)",            height=500        )        st.plotly_chart(fig, use_container_width=True)        # Tahmin metrikleri        col1, col2, col3 = st.columns(3)        with col1:            st.metric(                "Model DoÄŸruluÄŸu",                f"%{pred_metrics['r2'] * 100:.1f}",                "RÂ² Skoru"            )        with col2:            trend = "YÃ¼kseliÅŸ" if pred_metrics['slope'] > 0 else "DÃ¼ÅŸÃ¼ÅŸ"            st.metric(                "Trend YÃ¶nÃ¼",                trend,                f"{abs(pred_metrics['slope']):,.0f} TL/Ay"            )        with col3:            st.metric(                "Tahmin HatasÄ±",                f"â‚º{pred_metrics['rmse']:,.0f}",                "RMSE"            )        # Tahmin detaylarÄ±        st.markdown("#### ğŸ“‹ Tahmin DetaylarÄ±")        predictions_df = pd.DataFrame({            'Ay': future_months,            'Tahmini SatÄ±ÅŸ': [f"â‚º{p:,.0f}" for p in predictions],            'Alt SÄ±nÄ±r': [f"â‚º{p:,.0f}" for p in lower_bound],            'Ãœst SÄ±nÄ±r': [f"â‚º{p:,.0f}" for p in upper_bound]        })        st.dataframe(            predictions_df,            hide_index=True,            use_container_width=True        )def show_expense_prediction(metrics, periods, confidence):    """Gider tahmini gÃ¶ster"""    predictions, pred_metrics = create_expense_prediction(metrics, periods)    # Benzer ÅŸekilde gider tahmin grafiÄŸi ve metrikleri gÃ¶ster...def show_profit_prediction(metrics, periods, confidence):    """Kar tahmini gÃ¶ster"""    # SatÄ±ÅŸ ve gider tahminlerini kullanarak kar tahmini yap...if __name__ == "__main__":    show_predictions()